all:
	g++ -I. -I/usr/include/nss -I/usr/include/nspr -D__CEPH__ -D_FILE_OFFSET_BITS=64 -D_REENTRANT -D_THREAD_SAFE -D__STDC_FORMAT_MACROS -D_GNU_SOURCE -rdynamic -Wall -Wtype-limits -Wignored-qualifiers -Winit-self -Wpointer-arith -Werror=format-security -fno-strict-aliasing -fsigned-char -Wnon-virtual-dtor -Wno-invalid-offsetof -Wstrict-null-sentinel   -g -O2 -c -o fio_ceph_filestore.o  fio_ceph_filestore.c -fPIC -D_GNU_SOURCE
	g++ -I/usr/include/nss -I/usr/include/nspr -D__CEPH__ -D_FILE_OFFSET_BITS=64 -D_REENTRANT -D_THREAD_SAFE -D__STDC_FORMAT_MACROS -D_GNU_SOURCE -rdynamic -Wall -Wtype-limits -Wignored-qualifiers -Winit-self -Wpointer-arith -Werror=format-security -fno-strict-aliasing -fsigned-char -DCEPH_LIBDIR=\"/usr/local/lib\" -Wnon-virtual-dtor -Wno-invalid-offsetof -Wstrict-null-sentinel -g -O2 -Wl,--as-needed -o fio_ceph_filestore.so fio_ceph_filestore.o -L.libs/ -loss -laio ./.libs/libglobal.a -latomic_ops -lpthread -lm -lnss3 -lnssutil3 -lsmime3 -lssl3 -lplds4 -lplc4 -lnspr4 -luuid -lrt -lboost_thread-mt -lboost_system-mt -lleveldb -lsnappy -shared

run:
	LD_LIBRARY_PATH=.libs/ ~/projects/fio/fio --ioengine=./fio_ceph_filestore.so --iodepth=1 --name=foo --invalidate=0 --rw=randwrite --bs=4k --iodepth=2 --size=1m --minimal
